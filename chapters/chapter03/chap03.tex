%
% File: chap03.tex
% Author: Henry Semenenko
% Description: HOM Interference
%
% Set the graphics path to find figures
\graphicspath{{./chapters/chapter03/fig03/}}

\let\textcircled=\pgftextcircled
\chapter[HOM Interference Between Integrated Devices]{Hong-Ou-Mandel Interference Between Integrated Devices}
\label{chap:hom}
%=======

\section{Introduction}

\ac{HOM} interference is a fundamental tool in any quantum engineer's toolbox. It underpins a range of quantum technologies ranging from computing to communication. While it is well understood, generating states for quantum interference at the high speeds required for modern telecommunication remains practically challenging. In this chapter, we experimentally demonstrate that \ac{InP} devices fulfil all the requirements of state-of-the-art Hong-Ou-Mandel interference while also being practically scalable. This chapter will expand on the work published in references \cite{semenenko2019}. 

\section{Hong-Ou-Mandel Interference}

\Ac{HOM} interference is a quantum phenomena where two indistinguishable single photons incident on a balanced beam splitter will interfere and bunch. This is an important physical process that is fundamental to many quantum information technologies from computation to communication and sensing. It was first seen by Hong, Ou and Mandel in 1987 \cite{HOM}. 

Consider two single photons indistinguishable only in their spatial modes. This can be mathematically represented as 

\begin{equation}
	\hat{a}^\dagger \hat{b}^\dagger \ket{0,0}_{a,b} = \ket{1,1}_{a,b}
\end{equation}

In general we can consider a beam splitter to have some reflection component, $r$, and some transmission component, $t$. The transformation matrix is given as 

\begin{equation}
	\left(
	\begin{matrix}
		t^\ast & r \\
		-r^\ast & t
	\end{matrix}
	\right)
	\quad\text{such that}\quad
	|r|^2 + |t|^2 = 1 
	\quad\text{and}\quad
	r^\ast t + r t^\ast = 0
\end{equation}
where $|r|^2$ and $|t|^2$ are the probabilities of reflection and transmission, respectively. For a balance beam splitter, the transformation matrix becomes
\begin{equation}
	\text{BS}_{50:50} = \frac{1}{\sqrt{2}}
	\left(
	\begin{matrix}
		1 & i \\
		i & 1
	\end{matrix}
	\right)	
\end{equation}

The beam splitter transformation can also be written as 
\begin{equation}
	\text{BS}_{50:50} = \frac{1}{\sqrt{2}}
	\left(
	\begin{matrix}
		1 & 1 \\
		1 & -1
	\end{matrix}
	\right)	
\end{equation}
when we do not wish to consider the relative phases of the output modes. For example, in a \ac{HOM} experiment we are typically only concerned with coincidences of the photons after the beam splitter and not their phases.

\subsection{Coherent States on a Beam Splitter}

While \ac{HOM} interference is typically considered when single photons interfere on a beam splitter, the same phenomena can be seen with coherent states.  However, the visibility of interference is limited to 50\% \cite{Rarity2005} due to multiphoton terms.

Consider two coherent states, $\ket{\alpha}$ and $\ket{\beta}$, incident on a beam splitter. Before the beam splitter, the states can be written as

\begin{equation}
\begin{split}
	\ket{\alpha} = \text{D}(\alpha)\ket{0} = e^{\alpha a^\dagger - \alpha^\ast a}\ket{0} = e^{-\frac{|\alpha|^2}{2}} e^{-\alpha^\ast a} e^{\alpha a^\dagger}\ket{0}\\
	\ket{\beta} = \text{D}(\beta)\ket{0} = e^{\beta b^\dagger - \beta^\ast b}\ket{0} = e^{-\frac{|\beta|^2}{2}} e^{-\beta^\ast b} e^{\beta b^\dagger}\ket{0}
\end{split}
\end{equation}
which, before the beam splitter, can be written jointly as
\begin{equation}
	\text{D}(\alpha)\otimes\text{D}(\beta)\ket{0}
\end{equation}

For generality, we can consider a beam splitter in terms of reflections, $r$, and transmissions, $t$, which yields the transformation matrix
\begin{equation}
	\left(
	\begin{matrix}
		t & r \\
		-r & t
	\end{matrix}
	\right)
	\quad\text{such that}\quad
	|r|^2 + |t|^2 = 1 
	\quad\text{and}\quad
	r^\ast t + r t^\ast = 0
\end{equation}
Using this beam splitter, where modes $a$ and $b$ are the incoming channels and $c$ and $d$ are the outgoing, the transformations are
\begin{equation}
	a^\dagger \rightarrow rc^\dagger + td^\dagger, \quad a \rightarrow r^\ast c + t^\ast d, \quad b^\dagger \rightarrow tc^\dagger - rd^\dagger, \quad b \rightarrow t^\ast c - r^\ast d
\end{equation}
so after the beam splitter, the state becomes
\begin{align}
	\text{D}_a(\alpha)\otimes\text{D}_b(\beta)\ket{0} &=  e^{\alpha a^\dagger - \alpha^\ast a} e^{\beta b^\dagger - \beta^\ast b}\ket{0}\\
	&\longrightarrow  e^{\alpha (r c^\dagger + t d^\dagger) - \alpha^\ast (r^\ast c + t^\ast d)}e^{\beta (t c^\dagger - r d^\dagger) - \beta^\ast (t^\ast c - r^\ast d)}\ket{0}\\
	&=  e^{(\alpha r + \beta t) c^\dagger - (\alpha^\ast r^\ast + \beta^\ast t^\ast) c} e^{(\alpha t - \beta r) d^\dagger - (\alpha^\ast t^\ast - \beta^\ast r^\ast) d}\ket{0}\\
	&=  \text{D}_c(\alpha r + \beta t)\text{D}_d(\alpha t - \beta r)\ket{0}
\end{align}
given a 50:50 beam splitter, this gives the output $\text{D}_c(\frac{1}{\sqrt{2}}\big(i\alpha + \beta\big))\text{D}_d(\frac{1}{\sqrt{2}}\big(\alpha - i\beta\big))$. The single photon detectors are threshold, meaning that single photon events are not distinguishable from multi-photon events. The two detectors $\text{Det}_1$ and $\text{Det}_2$ have efficiencies $\eta_1$ and $\eta_2$, respectively. Therefore, the probability of a click in $\text{Det}_\text{c}$ is given by
\begin{align}
	\text{P}(\text{Det}_1 \text{ click}) &= \sum_{n=0}^\infty \frac{|\alpha r + \beta t|^{2n} e^{-|\alpha r + \beta t|^2}}{n!}(1-(1-\eta_1)^n)\\
	&= 1 - e^{-|\alpha r + \beta t|^2 \eta_1}
\end{align}
and equivalently,
\begin{equation}
	\text{P}(\text{Det}_2 \text{ click}) = 1 - e^{-|\alpha t - \beta r|^2 \eta_2}
\end{equation}
Therefore, the probability of a coincidence click, with both coherent states overlapped on a beam splitter, is
\begin{align}
	\text{P}_\text{HOM}\text{(coincidence)} &= \text{P}(\text{Det}_1 \text{ click}) \times \text{P}(\text{Det}_2 \text{ click})\\
	&= \left(1 - e^{-|\alpha r + \beta t|^2 \eta_1}\right)\left(1 - e^{-|\alpha t - \beta r|^2 \eta_2}\right)
\end{align}

\begin{figure}[tbp]
\begin{tikzpicture}
\begin{axis}[
    axis line on top,
	xlabel = {Reflectivity/Transmission},
	ylabel = {Visibility},
	width = 0.9\linewidth,
	height = 0.5\linewidth,
	cycle list name = RdYlGn-reversed,
	xmin = 0,
	xmax = 1,
	ymin = 0,
	ymax = 0.55,
	xtick pos=left,
	ytick pos=left,
	xtick = {0,0.25,0.5,0.75,1},
	ytick = {0,0.25,0.5},
    tick align=outside,
    grid=both,
    grid style={line width=.1pt, draw=gray!10},
    legend style={fill=blue!5, draw=gray!50}
	]
\addplot+[very thick] table[x index=0, y index = 1, col sep=comma] {./chapters/chapter03/fig03/HOM_Coherent/HOM_Bs_vis.dat};
\addlegendentry{0.01};
\foreach \y in {2,...,5}{
  \edef\temp{\noexpand\addlegendentry{\y}}
  \addplot+[very thick] table[x index=0,y index=\y, col sep=comma] {./chapters/chapter03/fig03/HOM_Coherent/HOM_Bs_vis.dat};
  \temp
}
\end{axis}
\end{tikzpicture}
	\caption[Coherent state photon number visibility]{Graph plotting the effect of an unbalanced beam splitter on the visibility of a HOM dip. Maximal visibility is found when the beam splitter is 50:50. Photon number also has an effect on visibility due to the increased probability of multi-photon terms. Here, we plot average photon numbers ranging from 0.01 to 5. Both states are assumed to have equal average photon number.}
	\label{fig:HOM_BS_Vis}
\end{figure}

To get a visibility for the HOM dip, we need to consider two coherent states not interfering on a beam splitter. The distributions after a beam splitter is a Poisson distribution of $P(|r\alpha|^2 + |t\beta|^2)$ and $P(|t\alpha|^2 + |r\beta|^2)$. Therefore, the probability of coincidence is given by
\begin{align}
	\text{P}_\text{ind}(\text{coincidence}) &= \left(1 - e^{-\eta_1(|r\alpha|^2 + |t\beta|^2)}\right)\left(1 - e^{-\eta_2(|t\alpha|^2 + |r\beta|^2)}\right)
\end{align}
We want to consider pulses that are phase randomised relative to each other. For this, we can introduce a phase $e^{i\theta}$ into the pulse incident from channel $a$. The coincidence probabilities then become
\begin{align}
	&\text{P}_\text{HOM}\text{(coincidence)} = \frac{1}{2\pi}\int_0^{2\pi}\left(1 - e^{-|e^{i\theta}\alpha r + \beta t|^2 \eta_1}\right)\left(1 - e^{-|e^{i\theta}\alpha t - \beta r|^2 \eta_2}\right)\text{d}\theta\\
	&\text{P}_\text{ind}(\text{coincidence}) = \left(1 - e^{-\eta_1(|r\alpha|^2 + |t\beta|^2)}\right)\left(1 - e^{-\eta_2(|t\alpha|^2 + |r\beta|^2)}\right)
\end{align}
The visibility of the HOM dip can be calculated as
\begin{equation}
	\text{Visibility} = 1 - \frac{\text{P}_\text{HOM}}{\text{P}_\text{ind}}
\end{equation}

Using these equations, it is possible to estimate the visibility of a HOM dip given a beam splitter that is not 50:50. The effects of this will be seen in a reduced visibility. The average photon number of the pulses used will also affect the visibility as the detectors are threshold. In figure \ref{fig:HOM_BS_Vis} the effect of varying the photon number and using an unbalanced beam splitter on the visibility of interference.

\section{Sources and Requirements}
\label{sec:sources}

In this section, we will discuss the main challenges in performing \ac{HOM} interference and describe some of the photons sources that can be used to fulfil the stringent requirements of high visibility interference. It is well understood that for two light pulses to interfere, they need to be indistinguishable \cite{}. Put more explicitly, for maximal interference, the two pulses need to have the same wavelength; arrive at the same time; have equal intensities; be in the same polarisation; and have the same pulse shape.

\subsection{Single Photons}

Typically, \acl{HOM} experiments are usually performed with a single photons. The first demonstrations used \ac{spdc} to generate pairs of single photons that were distinguishable only in path \cite{}. By delaying one of the photons before interfering on a beam splitter, \ac{HOM} interference could be demonstrated. Subsequent experiments have demonstrated interference between single photons sources from \ac{sfwm} \cite{}, quantum dots \cite{} and NV centres \cite{}.

While there have been many advances in these types of sources through increased rates and coherence, they remain probabilistic. Therefore, it is hard to claim that they will make good candidates for scalable quantum technologies without requiring multiplexing and feed-forward which introduces a its own set of practical challenges.

On-demand single photon source would be the ideal candidate for many quantum technologies, including \acp{QKD}. However, the current state of the on-demand sources means limited rates that are often at wavelength incompatible with telecommunications \cite{}. 

\subsection{Weak Coherent States}

In the absence of true single photon sources, another source of light needs to be considered for scalable quantum communication. Coherent states represent a close approximation to single photons when strongly attenuated. They are also readily available easily manipulated. In the regime of low average photon number, we will introduce \acp{wcs}. While not entirely well defined, we will consider \ac{wcs} to be when the average photon number is around 1 within a time period.

As previously mentioned, the requirements for high-fidelity \ac{HOM}, and therefore \ac{QKD}, are stringent. Here we discuss some of the requirements for a \ac{wcs} sources. 

\subsubsection*{Extinction Ratio}

The states will need to be temporally modulated to create time-bins that determine coincidence windows. While this is not necessarily required for \ac{HOM} interference, it will be important to use these states to encode quantum states for communication purposes. As we will be working with single photons states, it is important that there is a good distinction between \textit{on} and \textit{off} which we will call the extinction ratio. 

\subsubsection*{Timing Jitter}

In order to keep up with the data transfers on the web today, we will need to have clock speeds that are comparable. Therefore, as we need to encoding information in time, it is important that we have a low timing jitter to ensure time-bins remain separate even at GHz speeds.

\subsubsection*{Coherence}

For interference, we need to be sure that the state that arrives is the same as what was sent. Therefore, the coherence of the laser used needs to have a good coherence length, which means a narrow line width.

\subsubsection*{Phase Randomisation}

While it may seem counter-intuitive to require phase randomisation after also requiring long coherence lengths of the laser. However, phase randomisation between subsequent states is a vital part of \ac{HOM} interference with coherent states. Crucially, it is what distinguishes between the classical wave interference and the quantum \ac{HOM} interference.

\subsubsection*{Linearly Polarised}

As mentioned before, the states will need to be overlapped in each degree of freedom. The polarisation needs to be linear for interference.

Several methods can be conceived to generate \acp{wcp}.

\begin{itemize}
	\item Gain switched lasers (filter required and timing jitter problems)
	\item Laser seeding	(Multi-level and expensive control required, filtering required)
	\item Intensity modulation
\end{itemize}

\section{Experiment}

In this section, we detail the experimental setup used to demonstrate \ac{HOM} interference motivating the design with regards to the requirements set out in the previous section. 

\begin{figure}[tbp]
	\centering
	\includegraphics[width=\textwidth]{Experiment}
	\caption[HOM experimental setup]{Experimental setup of of the \ac{HOM} interference experiment with two identical \ac{InP} chips.}
	\label{fig:hom_experiment}
\end{figure}

The experiment uses two \ac{InP} devices as sources of weak coherent states. We will call each device Alice and Bob, respectively. Each chip measures only \SI[product-units=power]{6x2}{mm} and contains all the required photonic components to generate the required states to perform \ac{HOM} interference at GHz rates. One only need compare the sizes of these optical components to fibre based optics to justify the benefits of integrated devices.

\subsection{Light Source}

\begin{figure}
	\centering
	\includegraphics[width=0.6\textwidth]{/Chip/Oclaro_00_LASER.png}
	\caption{Integrated laser formed of two DBRs and an SOA.}
	\label{fig:InP_laser}
\end{figure}

As described in chapter \ref{chap:background}, a huge benefit for III-V materials such as \ac{InP} is the ability to monolithically integrate lasers onto devices. This makes the platform particularly suited for telecommunications and generating weak coherent states. 

The requirements for quantum communications are somewhat more stringent than that of classical communications. To this end, we need to verify the quality of the light sources to ensure that they will be able to perform high visibility interference. 

Each devices contains a Fabry-P\`{e}rot \acl{CW} laser which is shown in figure{\ref{fig:InP_laser}. The \SI{1}{mm} long cavity is made from two \acp{DBR} which are tunable through current injection and allow a wavelength tuning of $\approx \SI{10}{nm}$. From the picture, we can see that the \acp{DBR} are both the same length. Typically, the rear \ac{DBR} would be longer to increase the reflectivity back into the cavity which increases the laser power. While the applications here only require weak coherent states, \ac{cvqkd} requires a bright local oscillator which needs to be considered during chip design. Subsequent chip designs should considering this design change.

A typical spectra of the two transmitter lasers is shown in figure \ref{fig:spectra} which demonstrates a \SI{<30}{pm} \ac{FWHM} and a \SI{>50}{dB} sideband suppression. The linewidth here is stated as \SI{<30}{pm} \ac{FWHM} as this is limited to the precision of the \ac{OSA} used. 

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.8\textwidth]{spectrum}
	\caption[Laser spectrum]{Typical spectra of the two independent on-chip lasers. Each demonstrates a \ac{FWHM} of \SI{30}{pm} which is limited to the precision of the optical spectrum analyser used.}
	\label{fig:spectra}
\end{figure}

In order to measure the the linewidth more accurately, a self-heterodyne measurement technique can be used \cite{}. 

\subsection{Modulation}

From the laser, we will need to be able to intensity modulate our light to define time-bins for encoding. To be able to keep up with modern telecommunications, we will want the modulation to have \SI{10}{GHz} bandwidths. Our

We note here that the narrow linewidth of the laser means that during no experiment with the \ac{InP} chips do we need to use a wavelength filter to clean up the light or optical pulses. This is important as it removed a component that would add cost to any system but also restrict the wavelength operation of the devices. Without the need for a filter, the lasers are free to operate in a wavelength that spans more than \SI{10}{nm}. This will be crucial as it is likely that \ac{QKD} systems will needed to be \ac{wdm} to meet the demands of high-speed networks.

Alice (and Bob) uses a stable current sources to drive an on-chip \ac{DBR} laser which demonstrates a \ac{FWHM} of \SI{<30}{pm}, although this is limited by the precision of the \ac{OSA} used.

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.8\textwidth]{Pulse}
	\caption[Pulse carving]{Pulse carving showing \SI{>20}{dB} extinction ratio and a \ac{FWHM} of \SI{175}{\pico\second}.}
	\label{fig:pulses}
\end{figure}

\section{Hong-Ou-Mandel Interference Between GHz Coherent States}

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.8\textwidth]{HOM}
	\caption[Hong-Ou-Mandel interference between integrated devices]{\ac{HOM} interference between two integrated devices demonstrating $46.5\pm0.8\%$ visibility.}
	\label{fig:HOM}
\end{figure}

In figure \ref{fig:HOM} we demonstrate $46.5 \pm 0.8  \%$ visibility between two independent \acp{pic} by changing one transmitter's wavelength relative to the other. The transmitters we initially overlapped in time, using electronic delays; polarisation, with fibre polarisation controllers; and photon number, with digital variable optical attenuators. 

We think that it is pertinent to note that during the experiment there was no active feedback to control the polarisation, pulse carving or timing which demonstrates the stability possible with an integrated platform. 

\section{Phase Randomisation}

As we will see in chapter \ref{chap:mdiqkd}, it will be important for the pulses to be phase randomised relative to subsequent pulses to maintain the security of a \ac{QKD} protocol. This section will describe how we can use coincidence counts between neighbouring pulses to verify that we are creating phase randomised \acp{wcp}.

Laser gain switching is a technique used to cause phase randomisation by keep the laser below threshold and only applying current when a \ac{wcp} is desired. As the pulses are limited to the timing of a spontaneous emission, the timing jitter of the pulses is usually large. There is also a wavelength broadening meaning that filtering is required. 

Instead of gain switching to generate pulses, we can reverse the high speed pulse to provide a negative voltage between pulse carving. This pulses removes the carriers in the laser and makes each pulse phase randomised. The upper-state lifetime of semiconductors is very short, as is the cavity lifetime. Therefore, we can still generate states at \SI{250}{MHz} and demonstrate good state preparation.

\section{Outlook}

In this experiment, we have demonstrated state-of-the-art \acl{HOM} interference between GHz clocked integrated photonic devices exploiting monolithically fabricated lasers and \acp{eopm} with a visibility of $46.5\pm 0.8\%$. As we will see in chapter \ref{chap:mdiqkd}, this result will play a crucial role in \ac{MDI} and high fidelity interference will be required to bound the knowledge of Eve and Mallory.

\subsection{Active Stabilisation}

To maintain a high fidelity interference between the two devices over a prolonged period will require feedback as the devices will drift. 

Polarisation can be stabilised by utilising the unused arm of the \ac{pbs} to monitor counts and using an digitally controlled polarisation controller to keep the polarisation stable.

Wavelength can be stabilised using the visibility of \ac{HOM} interference by minimising coincidences. By changing the current of one of the transmitters, the wavelength can be very finely tuned. While this will change the power of the laser, if only small changes in current are required then this power change will be negligible.

Timing stabilisation can be achieved by looking at the time of arrival of the pulses. In particular, the \ac{FWHM} can be used to ensure that the pulses are overlapped i.e. minimising the \ac{FWHM} in the histogram of detection events means that the pulses will be maximally overlapped.

Average photon number is harder to stabilise but is also the least susceptible to drifts. Having fibres glues onto chips and by using a stable current source to power the laser, it is unlikely that photon number will need often retuning.

\subsection{Wavelength Division Multiplexing}

As mentioned previously, there is no need to filter the pulses to see interference. This is important as it allows the transmitters to be easily wavelength tuned making it compatible with \ac{wdm} and possible classical-quantum multiplexing. 

%=========================================================