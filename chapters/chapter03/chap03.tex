% File: chap03.tex
% Author: Henry Semenenko
% Description: HOM Interference
%
% Set the graphics path to find figures
\graphicspath{{./chapters/chapter03/fig03/}}

\let\textcircled=\pgftextcircled
\chapter[HOM Interference Between Integrated Devices]{Hong-Ou-Mandel Interference Between Integrated Devices}
\label{chap:hom}
%=======

\section*{Statement of Work}

The photonic chips were initially conceived by Mark Thompson and Mark Godfrey. The chip mask was designed by Mark Godfrey and fabricated by Oclaro. The experiment was initially design by Chris Erven and Philip Sibson and the chips were characterised by Philip Sibson. I modified the initial experimental design and modified the PCB design for chip packaging. Experimental setup, coding and analysis was supported by Philip Sibson. 

\section{Introduction}

\ac{HOM} interference is a fundamental tool in any quantum engineer's toolbox. It underpins a range of quantum technologies ranging from computing to communication. While it is well understood, generating states for quantum interference at the high speeds required for modern telecommunication remains practically challenging. In this chapter, we experimentally demonstrate that \ac{InP} devices fulfil all the requirements of state-of-the-art Hong-Ou-Mandel interference while also being practically scalable. This chapter will expand on the work published in reference \cite{semenenko2019}. 

A typical wave of overlapping the wavelengths of two lasers will involve interfering the two fields on a beam splitter and measuring the power output from one of the arms with a photodiode. However, by the time the laser has been coupled from the chip, the power is typically below \SI{30}{dBm}. It is challenging to create fast photodiodes that are sensitive enough to measure this power. Therefore, another method is required.

\section{Hong-Ou-Mandel Interference}

\Ac{HOM} interference is a quantum phenomena where two indistinguishable single photons incident on a balanced beam splitter will interfere and bunch. This is an important physical process that is fundamental to many quantum information technologies from computation to communication and sensing. It was first seen by Hong, Ou and Mandel in 1987 \cite{HOM}. 

Consider two single photons indistinguishable only in their spatial modes. This can be mathematically represented as 

\begin{equation}
	\hat{a}^\dagger \hat{b}^\dagger \ket{0,0}_{a,b} = \ket{1,1}_{a,b}
\end{equation}

In general we can consider a beam splitter to have some reflection component, $r$, and some transmission component, $t$. The transformation matrix is given as 

\begin{equation}
	\left(
	\begin{matrix}
		t^\ast & r \\
		-r^\ast & t
	\end{matrix}
	\right)
	\quad\text{such that}\quad
	|r|^2 + |t|^2 = 1 
	\quad\text{and}\quad
	r^\ast t + r t^\ast = 0
\end{equation}
where $|r|^2$ and $|t|^2$ are the probabilities of reflection and transmission, respectively. For a balance beam splitter, the transformation matrix becomes
\begin{equation}
	\text{BS}_{50:50} = \frac{1}{\sqrt{2}}
	\left(
	\begin{matrix}
		1 & i \\
		i & 1
	\end{matrix}
	\right)	
\end{equation}

The beam splitter transformation can also be written as 
\begin{equation}
	\text{BS}_{50:50} = \frac{1}{\sqrt{2}}
	\left(
	\begin{matrix}
		1 & 1 \\
		1 & -1
	\end{matrix}
	\right)	
\end{equation}
when we do not wish to consider the relative phases of the output modes. For example, in a \ac{HOM} experiment we are typically only concerned with coincidences of the photons after the beam splitter and not their phases.

\subsection{Coherent States on a Beam Splitter}

While \ac{HOM} interference is typically considered when single photons interfere on a beam splitter, the same phenomena can be seen with coherent states.  However, the visibility of interference is limited to 50\% \cite{Rarity2005} due to multiphoton terms.

Consider two coherent states, $\ket{\alpha}$ and $\ket{\beta}$, incident on a beam splitter. Before the beam splitter, the states can be written as

\begin{equation}
\begin{split}
	\ket{\alpha} = \text{D}(\alpha)\ket{0} = e^{\alpha a^\dagger - \alpha^\ast a}\ket{0} = e^{-\frac{|\alpha|^2}{2}} e^{-\alpha^\ast a} e^{\alpha a^\dagger}\ket{0}\\
	\ket{\beta} = \text{D}(\beta)\ket{0} = e^{\beta b^\dagger - \beta^\ast b}\ket{0} = e^{-\frac{|\beta|^2}{2}} e^{-\beta^\ast b} e^{\beta b^\dagger}\ket{0}
\end{split}
\end{equation}
which, before the beam splitter, can be written jointly as
\begin{equation}
	\text{D}(\alpha)\otimes\text{D}(\beta)\ket{0}
\end{equation}

For generality, we can consider a beam splitter in terms of reflections, $r$, and transmissions, $t$, which yields the transformation matrix
\begin{equation}
	\left(
	\begin{matrix}
		t & r \\
		-r & t
	\end{matrix}
	\right)
	\quad\text{such that}\quad
	|r|^2 + |t|^2 = 1 
	\quad\text{and}\quad
	r^\ast t + r t^\ast = 0
\end{equation}
Using this beam splitter, where modes $a$ and $b$ are the incoming channels and $c$ and $d$ are the outgoing, the transformations are
\begin{equation}
	a^\dagger \rightarrow rc^\dagger + td^\dagger, \quad a \rightarrow r^\ast c + t^\ast d, \quad b^\dagger \rightarrow tc^\dagger - rd^\dagger, \quad b \rightarrow t^\ast c - r^\ast d
\end{equation}
so after the beam splitter, the state becomes
\begin{align}
	\text{D}_a(\alpha)\otimes\text{D}_b(\beta)\ket{0} &=  e^{\alpha a^\dagger - \alpha^\ast a} e^{\beta b^\dagger - \beta^\ast b}\ket{0}\\
	&\longrightarrow  e^{\alpha (r c^\dagger + t d^\dagger) - \alpha^\ast (r^\ast c + t^\ast d)}e^{\beta (t c^\dagger - r d^\dagger) - \beta^\ast (t^\ast c - r^\ast d)}\ket{0}\\
	&=  e^{(\alpha r + \beta t) c^\dagger - (\alpha^\ast r^\ast + \beta^\ast t^\ast) c} e^{(\alpha t - \beta r) d^\dagger - (\alpha^\ast t^\ast - \beta^\ast r^\ast) d}\ket{0}\\
	&=  \text{D}_c(\alpha r + \beta t)\text{D}_d(\alpha t - \beta r)\ket{0}
\end{align}
given a 50:50 beam splitter, this gives the output $\text{D}_c(\frac{1}{\sqrt{2}}\big(i\alpha + \beta\big))\text{D}_d(\frac{1}{\sqrt{2}}\big(\alpha - i\beta\big))$. The single photon detectors are threshold, meaning that single photon events are not distinguishable from multi-photon events. The two detectors $\text{Det}_1$ and $\text{Det}_2$ have efficiencies $\eta_1$ and $\eta_2$, respectively. Therefore, the probability of a click in $\text{Det}_\text{c}$ is given by
\begin{align}
	\text{P}(\text{Det}_1 \text{ click}) &= \sum_{n=0}^\infty \frac{|\alpha r + \beta t|^{2n} e^{-|\alpha r + \beta t|^2}}{n!}(1-(1-\eta_1)^n)\\
	&= 1 - e^{-|\alpha r + \beta t|^2 \eta_1}
\end{align}
and equivalently,
\begin{equation}
	\text{P}(\text{Det}_2 \text{ click}) = 1 - e^{-|\alpha t - \beta r|^2 \eta_2}
\end{equation}
Therefore, the probability of a coincidence click, with both coherent states overlapped on a beam splitter, is
\begin{align}
	\text{P}_\text{HOM}\text{(coincidence)} &= \text{P}(\text{Det}_1 \text{ click}) \times \text{P}(\text{Det}_2 \text{ click})\\
	&= \left(1 - e^{-|\alpha r + \beta t|^2 \eta_1}\right)\left(1 - e^{-|\alpha t - \beta r|^2 \eta_2}\right)
\end{align}

\begin{figure}[tbp]
\begin{tikzpicture}
\begin{axis}[
    axis line on top,
	xlabel = {Reflectivity/Transmission},
	ylabel = {Visibility},
	width = 0.9\linewidth,
	height = 0.5\linewidth,
	cycle list name = RdYlPu-8,
	xmin = 0,
	xmax = 1,
	ymin = 0,
	ymax = 0.55,
	xtick pos=left,
	ytick pos=left,
	xtick = {0,0.25,0.5,0.75,1},
	ytick = {0,0.25,0.5},
    tick align=outside,
    grid=both,
    grid style={line width=.1pt, draw=gray!10},
    legend style={fill=blue!5, draw=gray!50}
	]
\addplot+[very thick] table[x index=0, y index = 1, col sep=comma] {./chapters/chapter03/fig03/HOM_Coherent/HOM_Bs_vis.dat};
\addlegendentry{0.01};
\foreach \y in {2,...,8}{
  \edef\temp{\noexpand\addlegendentry{\y}}
  \addplot+[very thick] table[x index=0,y index=\y, col sep=comma] {./chapters/chapter03/fig03/HOM_Coherent/HOM_Bs_vis.dat};
  \temp
}
\end{axis}
\end{tikzpicture}
	\caption[Coherent state photon number visibility]{Graph plotting the effect of an unbalanced beam splitter on the visibility of a HOM dip. Maximal visibility is found when the beam splitter is 50:50. Photon number also has an effect on visibility due to the increased probability of multi-photon terms. Here, we plot average photon numbers ranging from 0.01 to 5. Both states are assumed to have equal average photon number.}
	\label{fig:HOM_BS_Vis}
\end{figure}

To get a visibility for the HOM dip, we need to consider two coherent states not interfering on a beam splitter. The distributions after a beam splitter is a Poisson distribution of $P(|r\alpha|^2 + |t\beta|^2)$ and $P(|t\alpha|^2 + |r\beta|^2)$. Therefore, the probability of coincidence is given by
\begin{align}
	\text{P}_\text{ind}(\text{coincidence}) &= \left(1 - e^{-\eta_1(|r\alpha|^2 + |t\beta|^2)}\right)\left(1 - e^{-\eta_2(|t\alpha|^2 + |r\beta|^2)}\right)
\end{align}
We want to consider pulses that are phase randomised relative to each other. For this, we can introduce a phase $e^{i\theta}$ into the pulse incident from channel $a$. The coincidence probabilities then become
\begin{align}
	&\text{P}_\text{HOM}\text{(coincidence)} = \frac{1}{2\pi}\int_0^{2\pi}\left(1 - e^{-|e^{i\theta}\alpha r + \beta t|^2 \eta_1}\right)\left(1 - e^{-|e^{i\theta}\alpha t - \beta r|^2 \eta_2}\right)\text{d}\theta\\
	&\text{P}_\text{ind}(\text{coincidence}) = \left(1 - e^{-\eta_1(|r\alpha|^2 + |t\beta|^2)}\right)\left(1 - e^{-\eta_2(|t\alpha|^2 + |r\beta|^2)}\right)
\end{align}
The visibility of the HOM dip can be calculated as
\begin{equation}
	\text{Visibility} = 1 - \frac{\text{P}_\text{HOM}}{\text{P}_\text{ind}}
\end{equation}

Using these equations, it is possible to estimate the visibility of a HOM dip given a beam splitter that is not 50:50. The effects of this will be seen in a reduced visibility. The average photon number of the pulses used will also affect the visibility as the detectors are threshold. In figure \ref{fig:HOM_BS_Vis} the effect of varying the photon number and using an unbalanced beam splitter on the visibility of interference.

\subsection{Modelling}

The \ac{CW} laser was intensity modulated into pulses using an \ac{mzi} which gave the pulse a Gaussian shape in time. Therefore, we can model the electric field of each pulse as
\begin{equation}
	\mathcal{E}_j^\text{in}(t) = \frac{1}{t_p\sqrt{2\pi}} \exp{\left(-\frac{t^2}{2 t_p^2}\right)} \exp{\left(i(\omega_j t + \varphi_j)\right)}
\end{equation}
where $j = 1,2$ are the beam splitter inputs. The pulse duration is given by $t_p$, the laser angular frequency is $\omega_j$ and $\varphi_j$ is the phase associated with the pulse. By taking the Fourier transform of the electric field, we can calculate the shape in frequency space as 
\begin{equation}
	\mathcal{E}_j^\text{in}(\omega_j) = A \exp{\left(-\frac{t^2}{2 \omega_p^2}\right)} \exp{\left(i(\omega_j t + \varphi_j)\right)}
\end{equation}

To find the overlap, we calculate the convolution of the two functions in frequency space which will be our degree of indistinguishability. The convolution is 
\begin{equation}
	(f \ast g)(t) = \int^{\inf}_{\inf} f(\tau)g(t - \tau) \text{d}\tau
\end{equation}  

The two pulses from the transmitters interfere at the beam splitter. After the interference, the intensities at the output of each arm is given as
\begin{equation}
	I^\text{out}_{1,2} = 1 \pm \exp{\left(-\frac{1}{2}t_p^2(\Delta\omega)^2\right)}\cos(\Delta\varphi)
\end{equation}
where $\pm$ distinguishes between the two output modes. The relative phases of the pulses, $\Delta\varphi = \varphi_1 - \varphi_2$, is introduced to simplify the equation.

We are then able to calculate the coincidence probability by using $P(1,1) \propto \langle I_1 I_2\rangle$ \cite{Rarity2005}, where an average is taken over the relative phase, $\Delta\varphi$. As the laser pulses tune in wavelength, we can model the \ac{HOM} interaction as 
\begin{equation}
	P(1,1) = 1 - V \exp{\left(-t_p^2(\Delta\omega)^2\right)}
	\label{eq:gaussian}
\end{equation}
where the visibility, $V$, takes into account any mismatch in the degrees of freedom between the two pulses (i.e. timing, polarisation, pulse shape or photon number). In the case where the pulses were perfectly indistinguishable, we could have $V = 0.5$ as the visibility is limited due to the multi-photon terms in coherent states.

We can distinguish this as quantum interference from a classical Mach-Zehnder fringe as the number of events in each detector will not decrease at the lasers overlap in wavelength. This difference is due to the phase randomised nature of the incoming light.

\section{Sources and Requirements}
\label{sec:sources}

In this section, we will discuss the main challenges in performing \ac{HOM} interference and describe some of the photons sources that can be used to fulfil the stringent requirements of high visibility interference. It is well understood that for two light pulses to interfere, they need to be indistinguishable \cite{}. Put more explicitly, for maximal interference, the two pulses need to have the same wavelength; arrive at the same time; have equal intensities; be in the same polarisation; and have the same pulse shape.

\subsection{Single Photons}

Historically, \acl{HOM} interference experiments have been performed with a single photons. The first demonstrations used \ac{spdc} to generate pairs of single photons that were distinguishable only in path \cite{}. By delaying one of the photons before interfering on a beam splitter, \ac{HOM} interference could be demonstrated. Subsequent experiments have demonstrated interference between single photons sources from \ac{sfwm} \cite{}, quantum dots \cite{} and NV centres \cite{} \footnote{A recent review can be found at \url{http://www.rri.res.in/quic/resources/opn2019}}.

While there have been many advances in single-photon sources through increased rates and coherence, they remain probabilistic with impractical rates for communication protocols. Therefore, it is hard to claim that in their current form they will make good candidates for scalable quantum technologies without requiring multiplexing and feed-forward techniques. Each of which introduce their own set of practical challenges. 

It is worth noting that as quantum networks evolve from simple key exchange networks it will be necessary to develop single-photon sources \cite{}. As such developments occur, they will impact the field of \ac{QKD} which would benefit from on-demand, single-photon sources provided that they fulfil the rate and loss requirements of modern communication networks. It could even be conceived that these sources would impact how we communicate our classical information \cite{}

\subsection{Weak Coherent States}

In the absence of true single photon sources, another source of light needs to be considered for scalable quantum encryption protocols. Coherent states represent a close approximation to single photons when strongly attenuated. They are also readily available and easily manipulated. In the regime of low average photon number, we will introduce the term \acp{wcs}. 

As previously mentioned, the requirements for high-fidelity \ac{HOM}, and therefore \ac{QKD}, are stringent. Here we discuss some of the requirements for a \ac{wcs} sources to be useful in a \ac{QKD} system. 

\subsubsection*{Extinction Ratio}

The states will need to be temporally modulated to create time-bins that determine coincidence windows. While this is not necessarily required for \ac{HOM} interference, it will be important to use these states to encode quantum states for communication purposes. It will also help synchronise the two transmitters in time so coincidences can be found more easily. As we will be working with single photons states, it is important that there is a good distinction between \textit{on} and \textit{off} which we will call the extinction ratio. 

\subsubsection*{Timing Jitter}

In order to keep up with the data transfers on the web today, we will need to have clock speeds that are comparable. Therefore, as we need to encoding information in time, it is important that we have a low timing jitter to ensure time-bins remain separate, with high extinction ratios, even at GHz speeds.

\subsubsection*{Coherence}

For interference, we need to be sure that the state that arrives is the same as what was sent. Therefore, the coherence of the laser used needs to have a good coherence length, which means a narrow line width. We also need to ensure that the coherence between the time-bins is maintained within a state.

\subsubsection*{Phase Randomisation}

While it may seem counter-intuitive to require phase randomisation after also requiring long coherence lengths of the laser. However, phase randomisation between subsequent states is a vital part of \ac{HOM} interference with coherent states. Crucially, it is what distinguishes between the classical wave interference and the quantum \ac{HOM} interference.

\subsubsection*{Linearly Polarised}

As mentioned before, the states will need to be overlapped in each degree of freedom. The polarisation needs to be linear for interference. While a \ac{pbs} can be used to ensure polarisation overlap for interference, this adds complexity and losses to the system. Orthogonal polarisations can also introduce side-channels into the system allows Eve to gain knowledge of the key exchange.

\subsubsection*{Wavelength Tunable}

Modern telecommunications networks heavily rely on \acp{wdm} to maintain the data rates required. To ensure quantum compatibility with the same networks, it is likely that the wavelength of a \ac{QKD} system will need to be tunable in order to switch between the standardised frequency bands. This may also restrict the use of wavelength filters, unless they are easily tunable. Moreover, unfiltered wavelengths can introduce side-channels which could be exploited by Eve or Mallory.

Several methods have been used to generate \acp{wcp} for \ac{QKD} systems. Here we discuss the benefits and drawbacks of each.

While gain switched lasers offer simplicity and easily satisfy the phase randomisation constraint, they  

\begin{itemize}
	\item Gain switched lasers (filter required and timing jitter problems)
	\item Laser seeding	(Multi-level and expensive control required, filtering required)
	\item Intensity modulation
\end{itemize}

\section{Integrated Transmitters}

\subsection{Packaging}

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.8\textwidth]{Chip_PCB}
	\caption[Transmitter PCB package]{Chip packaging to breakout the electrical connection on the chip. SMA connectors were used for the high-speed connections to offer a response of more than \SI{10}{\GHz}. Capacitors and resisters were also used for termination of RF modulation signals. DC pins were used for low-speed connections.}
	\label{fig:chip_pcb}
\end{figure}

To be able to access the electrical and optical sections of the integrated devices, we need to create a package to transfer the signals from the driving electronics to the chip . A PCB was designed to electrically connect the modulators and laser to SMA and DC pin connectors. The bottom of the chip is ground which connects to a copper block that is also connected to the ground of the PCB. Silver epoxy was used to glue the chip to the mount to ensure a good electrical connection. It also provided a good thermal connection for temperature stabilisation.

In order to maintain a good impedance match (\SI{50}{\ohm}) with small track widths, Rogers 6006ns material was chosen for its high dielectric constant of \num{6.15}. The tracks were designed and then laser etched into the copper on the substrate. The PCB was given a gold coating using electroplating to avoid oxidation of the copper and to help with gold wirebonding. In future iterations, a nickel layer should be applied before the gold to avoid gold diffusing into the copper. SMA, DC pins, capacitors and resistors were then soldered onto the PCB using a low temperature solder paste.

The pads on the chip were wirebonded to the PCB with a \SI{25}{\micro\meter} ball bond and then a wedgebond onto the PCB. Silver epoxy was then applied over the wedgebond to ensure a good electrical contact with the PCB and to increase durability. The PCB was designed such that the length of the RF wirebonds was minimised so that capacitance and resistance of the gold wire were reduced. Such effects can be detrimental for high-speed operation.

An RF signal could be applied to one side of a \ac{eopm} while the other side provided termination to minimise electrical reflections. A capacitor blocked the DC component of the signal while a \SI{50}{\ohm} resistor terminates the AC signal. 

\subsection{Laser Source}

\begin{figure}[tp]
	\centering
	\includegraphics[width=0.6\textwidth]{/Chip/Oclaro_00_LASER.png}
	\caption[Microscope image of the waveguide integrated Fabry-P\'{e}rot laser]{Waveguide integrated Fabry-P\'{e}rot laser formed of two \acp{DBR}, which formed a tunable optical cavity, and an \ac{SOA} for optical gain. The total length is only \SI{1}{\mm} and produces optical powers of up to \SI{1}{\milli\watt}.}
	\label{fig:InP_laser}
\end{figure}

As described in chapter \ref{chap:background}, a huge benefit for III-V materials such as \ac{InP} is the ability to monolithically integrate lasers onto devices. This makes the platform particularly suited for telecommunications and generating weak coherent states. 

The requirements for quantum communications are somewhat more stringent than that of classical communications. To this end, we need to verify the quality of the light sources to ensure that they will be able to perform high visibility interference. 

Each devices contains a Fabry-P\'{e}rot \ac{CW} laser which is shown in figure \ref{fig:InP_laser}. The \SI{1}{mm} long cavity is made from two \acp{DBR} which are tunable through current injection and allow a wavelength tuning of \SI{10}{nm}. The laser was tested with up to \SI{100}{\mA} which was limited by the current source. The power increase in the laser is linear. However, due to heating of the cavity the wavelength hops modes at currents above around \SI{60}{\mA}.

From the picture, we can see that the \acp{DBR} are both the same length. Typically, the rear \ac{DBR} would be longer to increase the reflectivity back into the cavity which increases the laser power. While the applications here only require weak coherent states, \ac{cvqkd} requires a bright local oscillator which needs to be considered during chip design. Subsequent chip designs should considering this design change.

A typical spectra of the two transmitter lasers is shown in figure \ref{fig:spectra} which demonstrates a \SI{<30}{pm} \ac{FWHM} and a \SI{>50}{dB} sideband suppression. The linewidth here is stated as \SI{<30}{pm} \ac{FWHM} as this is limited to the precision of the \ac{OSA} used. The two lasers were deliberately offset in wavelength and the spectra show the reproducibility offered by integrated optics.

\begin{figure}[tbp]
	\centering
%	\includegraphics[width=0.8\textwidth]{spectrum}
	\def\svgwidth{0.8\textwidth} 
	\import{chapters/chapter03/fig03/}{spectrum.pdf_tex}
	\caption[On-chip laser spectra]{Typical spectra of the two independent on-chip lasers. Each demonstrates a \ac{FWHM} of \SI{30}{pm} (limited to the precision of the optical spectrum analyser) and a sideband suppression of \SI{50}{dB}. The two lasers were deliberately detuned in wavelength so both linewidths could be seen.}
	\label{fig:spectra}
\end{figure}

In figure \ref{fig:DBR_sweep} we can see the laser tuning through current injection of the \acp{DBR}. By varying the voltage from \SI{0}{\V} to \SI{1}{\V}, the wavelength can be tuned by about \SI{10}{\nm} within the telecommunications C-band. The wavelength can also be changed by changing the temperature of the device, which could cause the cavity to expand or contract. 

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.8\textwidth]{DBR_sweep}
	\caption[Laser wavelength scan with DBR current injection]{Through current injection of the \acp{DBR} we can change the wavelength of the laser due to heating effects. By sweeping the front and back \acp{DBR}, we can tune the laser \SI{10}{\nm} within the telecomms C-band.}
	\label{fig:DBR_sweep}
\end{figure}

\begin{figure}[tbp]
	\centering
	\def\svgwidth{\textwidth} 
	\import{chapters/chapter03/fig03/Laser_current_sweep/}{plot.pdf_tex}
	\caption[Laser wavelength current sweep]{By changing the driving current of the on-chip laser, we can change the wavelength through heating and carrier effects. This will also vary the power. As the laser current source can be varied in steps of \SI{10}{\nA}, we can see that the control of the laser wavelength through this effect can be very precise.}
	\label{fig:curr_sweep}
\end{figure}

In order to measure the the linewidth more accurately, a self-heterodyne measurement technique can be used \cite{self-heterodyne}. 

\subsection{Modulation}

\subsubsection{Electro-Optic Phase Modulation}

The main modulation effect that we will use is the \ac{qcse} which has operating speeds of more than \SI{40}{GHz} \cite{qcse, smit2014}. The waveguide contains a \ac{mqw}  structure which has a tunable bandgap depending on an applied reverse bias. This causes both a phase shift and loss.

\begin{figure}[tbp]
	\centering
	\includegraphics[width = 0.8\linewidth]{./Chip/Oclaro_00_MZI_1.png}
	\caption[Microscope image of an integrated Mach-Zehnder interferometer]{Integrated \acl{mzi} made from two \acsp{mmi} and two \acsp{eopm}  which can be used for intensity modulation of light into pulses. The \ac{mzi} measures only around \SI{1}{\mm} in length and around \SI{350}{\micro\metre} in width.}
	\label{fig:InP_MZI}
\end{figure}

From the laser, we will need to be able to intensity modulate our light to define time-bins for encoding. To be able to keep up with modern telecommunications, we will want the modulation to have \SI{10}{GHz} bandwidths. Our

In figure \ref{fig:InP_MZI} is a microscope image of the on-chip \ac{mzi} that is used for intensity modulation to define time-bins for the experiment.

Unlike directional couplers which exhibit a drastic wavelength dependent splitting ratio, \acp{mmi} are used to ensure a good splitting for a wide range of wavelengths. 

We note here that the narrow linewidth of the laser means that during no experiment with the \ac{InP} chips do we need to use a wavelength filter to clean up the light or optical pulses. This is important as it removed a component that would add cost to any system but also restrict the wavelength operation of the devices. Without the need for a filter, the lasers are free to operate in a wavelength that spans more than \SI{10}{nm}. This will be crucial as it is likely that \ac{QKD} systems will needed to be \ac{wdm} to meet the demands of high-speed networks.

Alice (and Bob) uses a stable current sources to drive an on-chip \ac{DBR} laser which demonstrates a \ac{FWHM} of \SI{<30}{pm}, although this is limited by the precision of the \ac{OSA} used.

\begin{figure}[tbp]
	\centering
	\def\svgwidth{\textwidth} 
	\import{chapters/chapter03/fig03/}{pulse.pdf_tex}
	\caption[On-chip intensity modulation of coherent states]{Histogram of intensity modulation after pulse carving with an \ac{mzi}. We find an extinction ratio of just over \SI{20}{dB} and a \ac{FWHM} of \SI{175}{\ps}. The pulse is not corrected for detector or time-tagging jitter.}
	\label{fig:pulses}
\end{figure}

\subsubsection{Thermo-Optic Phase Modulation}

In order to correct for imperfections in the fabrication of the devices, a thermo-optic effect can be used. While not design for thermo-optic modulation, the \acp{eopm} have a resistance of around \SI{10}{\ohm} which can be used to vary the phase.

\subsection{Fibre Coupling}

To efficiently couple the light from the waveguide mode (\SI{2}{\micro\metre}) to a fibre model (\SI{10}{\micro\metre}), a spot-size converter on the chip is used to expand the light mode to around \SI{3}{\micro\meter}. The spot-size converter also changes the mode to be more circular from the elliptical waveguide mode. A lensed fibre was then used to convert this mode to \SI{10}{\micro\meter}. The fibre was held in a Elliot Gold fibre launch stage with piezo actuators that gave a precision of \SI{10}{\nm} in X, Y and Z axes over a range of \SI{25}{\micro\meter}.

To reduce reflection back into the waveguide, the facet of the spot-size converter is at an angle relative to the edge of the chip. On these devices, the waveguides are at \SI{7}{\degree} to the edge which (using Snell's law given that the waveguide refractive index is around 3.26) we can calculate that the fibre should be at \SI{23}{\degree} to the edge of the chip.

Coupling losses were challenging to measure as the chip did not have any waveguide ``cutbacks'' to isolate the loss from components and spot-size converters.  However, loss from foundry measurements estimate that the loss from coupling to a singlemode fibre is around \SI{1.5}{dB}.

\section{Fibre Optic Transmitter}

\subsection{State Preparation}

A \ac{CW} fibre laser was used (Yenista t100s-hp) with a wide tuning around the C-band in steps of \SI{1}{\pm}. This meant that the laser could be sweep very precisely compared with the integrated laser, which would remain fixed.

The lithium niobate modulator was from ThorLabs and required a \SI{5}{\Vpp} pulse meaning that amplification of the signal from the \ac{ppg} was needed. The amplifier used was an SHF 810 with \SI{29}{dB} gain and up to \SI{40}{\GHz} operation. 


\section{Measurement}

The pulses are coupling into fibre allowing the rest of the experiment to make use of fibre components. 

In order to vary the pulse intensity, each transmitter has a digital \acp{voa}. These can be used to ensure a good match in powers between the two transmitters.

Fibre polarisation controllers are used to rotate the polarisation of the pulses and a \ac{pbs} gives a known polarisation in a polarisation maintaining fibre. 

A polarisation-maintaining {50:50} beam splitter is used for the interference to ensure that both transmitters are overlapped in polarisation.

Well engineered fibre components means that the losses through the fibre components is minimal. Photons are then sent for detection and time tagging.

\subsection{Detection}

The detectors used in the experiment were \acp{snspd} from Photonspot. Superconducting detectors were chosen over other single-photon detectors for their high efficiency (\SI{>80}{\percent}), small timing jitter (\SI{30}{\ps}) and short recovery time (\SI{100}{\ns}). The detectors were housed in a closed cycle helium refrigerator that was kept at \SI{0.7}{K}. A successful event was indicated by an RF signal of around \SI{10}{\mV} which was amplified with low-noise amplifier to around \SI{200}{\mV} which could then be time-tagged.

\subsection{Calibration}

Digital variable optical attenuators (Oz Optics DA100) were used to vary the power of each transmitters independently. 

\subsection{Synchronisation}

As the \ac{HOM} interference is dependant on the time of arrival of the two pulses, we need to ensure that the pulses arrive at the beam splitter at the same time. It is also crucial that we can reconstruct the events using the timing electronics, meaning that we require to fully calibrate electrical delays. This meant that the pulses that deemed to match in the time-tagging electronics were actually those that interfered at the beam splitter. 

By making the assumption that the total delay (optical and electronic) between the two arms of the measurement system after the beam splitter was less than \SI{50}{\ns}. This seemed reasonable as \SI{50}{\ns} in fibre equates to about \SI{12}{\m}, and is similar in the coaxial RF cables. Then the pulse generation could be slowed to send a pulse at less than \SI{10}{\MHz} so that the pulse separation was more than \SI{100}{\ns} and the pulses could be matched to the nearest coincident event. The delay between the arms of the meansurement in this experiment were found to be less than \SI{10}{\ns} which was verified through the \ac{HOM} interference.

To keep the transmitter electronics in sync with the detection electronics, an optical signal is used to send a reference clock. This 

\subsection{Time-tagging}

Detection events were time-tagged using a PicoQuant Hydraharp 400 and saved to a computer for later analysis. An optical link was used to provide a synchronisation signal from the transmitters to the time-tagger. The precision of timing events could be set by the user and could be as low as \SI{1}{\ps} and the electronic jitter is \SI{<12}{\ps}. The dead time of the tagging electronics is \SI{<80}{\ns}, which is comparable to the detector dead time so should not impact the experiment. In this experiment, \SI{16}{\ps} \textbf{CHECK THIS} bins were used. As the exact series of events could be reconstructed form the time-tags, the number of coincidences could be calculated from the saved tags provided the timing information between transmitters had been calibrated.

The coincidence window could be varied to in the analysis after to ensure that the coincidences come from when the pulse is a Gaussian shape. As we see from figure \ref{fig:pulses}, there is a `tail' on the later edge of the pulses would cause a chirp in the pulse. This would have two effects on the \ac{HOM} interference. Firstly, if the two pulse shapes are different, this would cause a reduced interference as the photons would have different wavelengths. Secondly, this would change the shape of the \ac{HOM} dip from the Gaussian shape that will be derived later.

\section{Control Electronics}

In order to the drive the devices, various electronic control is required. 

A DC voltage source was required to reverse bias the modulator. In lieu of a negative voltage source, a positive voltage source was used to raise the chip ground to \SI{10}{\V} relative to the other sources. The potential over modulators could then be applied using one of the other positive voltage sources.

The DC signal was mixed with the RF signal using a bias-tee with a response up to 

To generate the RF signals, a Keysight 81134A \ac{ppg} was used which had a maximum output voltage of up to \SI{2}{\Vpp}. A \ac{ppg} over a more general arbitrary waveform generator as only two levels were required for operation of the device for this test. The minimum pulse width that could be set was \SI{100}{\ps} which when measured on an oscilloscope (Keysight DSA91304A) were around \SI{120}{\ps} \ac{FWHM}. The maximum speed of the \ac{ppg} was \SI{3.35}{\GHz}. However, for this experiment the system clock was set to \SI{1.72}{\GHz}. A pulse was sent ever 4 clock cycles for a state repetition rate of \SI{431}{\MHz}.

A separate voltage source was used to pass a small current over one side of the \ac{mzi} to achieve thermo-optic phase modulation. The voltage could be set with a precision of \SI{1}{\mV} with typically \SIrange{200}{700}{\mV} being required for modulation. These values depended heavily on the fabrication of the device as well as packaging.

A 10K thermistor was used to give feedback to a PID loop controlled by an Arroyo 6601 and a peltier under the chip mount stabilised the temperature. The temperature is maintained around \SI{25}{\celsius} with an instability of less than \SI{0.01}{\celsius}. 

\section{Fibre Optic Hong-Ou-Mandel Demonstration}

To simplify the first tests of the integrated devices, a transmitter was setup using a fibre laser and lithium niobate intensity modulator so that \ac{HOM} interference could be demonstrated with a tested source. 

\subsection{State Preparation}

A \ac{CW} fibre laser was used (Yenista t100s-hp) with a wide tuning around the C-band in steps of \SI{1}{\pm}. This meant that the laser could be sweep very precisely compared with the integrated laser, which would remain fixed.

The lithium niobate modulator was from ThorLabs and required a \SI{5}{\Vpp} pulse meaning that amplification of the signal from the \ac{ppg} was needed. The amplifier used was an SHF 810 with \SI{29}{dB} gain and up to \SI{40}{\GHz} operation. 

\section{Hong-Ou-Mandel Interference Between Independent Integrated Devices}

\subsection{Experimental Setup}

In this section, we detail the experimental setup used to demonstrate \ac{HOM} interference motivating the design with regards to the requirements set out in the previous section. 

\begin{figure}[tbp]
	\centering
	\includegraphics[width=\textwidth]{Experiment}
	\caption[Hon-Ou-Mandel interference experimental setup]{Experimental setup of of the \ac{HOM} interference experiment. Two identical \ac{InP} chips prepare quantum states of light to be interfered on a {50:50} beams splitter. On-chip \ac{CW} lasers are intensity modulated into time-bins with \acp{mzi}. The pulses are coupled into a fibre where \acp{voa} ensure matched intensities and \acp{pc} and \acp{pbs} overlap the polarisation. An optical channel (not shown) synchronises the transmitter and detector electronics.}
	\label{fig:hom_experiment}
\end{figure}

The experiment uses two \ac{InP} devices as sources of weak coherent states. We will call each device Alice and Bob, respectively. Each chip measures only \SI[product-units=power]{6x2}{mm} and contains all the required photonic components to generate the required states to perform \ac{HOM} interference at GHz rates. One only need compare the sizes of these optical components to fibre based optics to justify the benefits of integrated devices.

\begin{figure}[tbp]
	\centering
%	\includegraphics[width=0.8\textwidth]{HOM}
	\def\svgwidth{0.8\textwidth} 
	\import{chapters/chapter03/fig03/}{HOM.pdf_tex}
	\caption[Hong-Ou-Mandel interference between integrated devices]{\ac{HOM} interference between two integrated devices demonstrating \SI{46.5(8)}{\%} visibility. By changing the relative wavelength ($\Delta\lambda$) between the two lasers the lasers become indistinguishable and the number of coincidences reduced to a visibility limited to \SI{50}{\percent}.}
	\label{fig:HOM}
\end{figure}

\acl{HOM} interference was demonstrated between two independent \acp{pic} operating at \SI{431}{\MHz} by varying the relative wavelengths of the lasers. Wavelength was chosen as the distinguishing degree of freedom as all others could be overlapped manually. However, a sweep in timing or polarisation would have seen similar interference. 

The two transmitters were initially overlapped in time, polarisation and photon number. Using ps resolution electronic delays in the pulse generation, a histogram from the \acp{spd} allowed a timing overlap between the pulses at the beam splitter. Care was taken to ensure that the pulses that were overlapped on the histogram matched with the pulses that could have interfered on the beam splitter and not a repetition rate or sync window apart. This required calibration of the relative optical and electronic delays after the beam splitter. 

Similarly, the photon number of each pulse was calibrated using a histogram of the pulses. This allowed the photon number to be calibrated regardless of the detector efficiency and fibre losses, provided that the beam splitter was balanced. By looking at each transmitter independently an average photon number per pulse was calculated to be $\sim 10^-3$. The value was chosen to minimise effects from multi-photon terms in the coherent state and to be far away from saturation of the detectors, both of which would have reduced the visibility.

As previously mentioned, current injection into the \ac{SOA} can be used to vary the wavelength with a precision of \SI{80}{\femto\metre}. However, this will also change the power of the laser and increase the number of photons per pulse. Therefore, a digital \ac{voa} was used to vary the attenuation during the sweep based on the sum total of detection events. The assumption was made that the power (coupling or otherwise) did not vary during the experiment. 

The polarisation of the transmitters was rotated using fibre polarisation controllers which was immediately sent through a \ac{pbs} after which was kept in polarisation maintaining fibre. The beam splitter used polarisation maintaining fibre to ensure that the polarisation did not change after the beam splitter. After the interference, the polarisation maintaining fibre was no longer required as only the time of arrival of photons was important at the detectors.

In figure \ref{fig:HOM} we demonstrate \SI{46.5(8)}{\percent} visibility between the two devices by sweeping the relative wavelengths of the lasers. We think that it is pertinent to note that during the experiment there was no active feedback to control the polarisation, pulse carving or timing which demonstrates the stability possible with an integrated platform. 

\section{HOM Interference with Actively Phase Randomised Pulses}

\begin{figure}[tbp]
	\centering
	\def\svgwidth{0.9\textwidth} 
	\import{chapters/chapter03/fig03/}{gain_switch.pdf_tex}
	\caption[Gain switching of the on-chip lasers at \SI{250}{MHz}]{By applying a negative electrical signal to the on-chip laser, we can drain the optical cavity. Lasing will then resume from spontaneous emission meaning that the phase will not be coherent with the previous lasing conditions. It takes around \SI{1}{\ns} for the laser to relax into a continuous operation from which states can be encoded.}
	\label{fig:gain_switch}
\end{figure}

As we will see in chapter \ref{chap:mdiqkd}, it will be important for the pulses to be phase randomised relative to subsequent pulses to maintain the security of a \ac{QKD} protocol. This section will describe how we can use coincidence counts between neighbouring pulses to verify that we are creating phase randomised \acp{wcp}.

As the lasers in previous experiment were not phase locked, we could average over the phases by taking data for long enough for the phases between the two lasers to drift.

Laser gain switching is a technique used to cause phase randomisation by keeping the laser below threshold and only applying current when a \ac{wcp} is desired. As the pulses are limited to the timing of a spontaneous emission, the timing jitter of the pulses is usually large. There is also a wavelength broadening meaning that filtering is required. 

Instead of gain switching to generate pulses, we can reverse the high speed pulse to provide a negative voltage between pulse carving. This pulses removes the carriers in the laser and makes each pulse phase randomised. The upper-state lifetime of semiconductors is very short, as is the cavity lifetime. Therefore, we can still generate states at \SI{250}{MHz} and demonstrate good state preparation.

To test that the pulses are phase randomised, we can look at coincidences between neighbouring pulses, as shown in figure \ref{fig:HOM_coherence}.  

\begin{figure}[tbp]
	\centering
	\includegraphics[width=\textwidth]{HOM_coherence.pdf}
	\caption[HOM interference with and without phase randomisation]{\ac{HOM} interference both with and without phase randomisation between pulses. We show the coincidences between pulses that interfered and check the coherence with subsequent pulses. In both cases, we find a fitted visibility of more than \SI{47}{\%} showing that phase randomisation doesn't reduce the fidelity of the states.}
	\label{fig:HOM_coherence}
\end{figure}

\section{Outlook}

In this experiment, we have demonstrated state-of-the-art \acl{HOM} interference between GHz clocked integrated photonic devices exploiting monolithically fabricated lasers and \acp{eopm} with a visibility of \SI{46.5(8)}{\%}. Further, we have demonstrated that gain switching the laser between pulses doesn't reduce the visibility. However, this does limit the speed of operation which will be a consideration for \ac{QKD} systems. As we will see in chapter \ref{chap:mdiqkd}, this result will play a crucial role in \ac{MDI} and high fidelity interference will be required to bound the knowledge of Eve and Mallory.

\subsection{Active Stabilisation}

To maintain a high fidelity interference between the two devices over a prolonged period will require feedback as the devices will drift. 

Polarisation can be stabilised by utilising the unused arm of the \ac{pbs} to monitor counts and using an digitally controlled polarisation controller to keep the polarisation stable.

Wavelength can be stabilised using the visibility of \ac{HOM} interference by minimising coincidences. By changing the current of one of the transmitters, the wavelength can be very finely tuned. While this will change the power of the laser, if only small changes in current are required then this power change will be negligible.

Timing stabilisation can be achieved by looking at the time of arrival of the pulses. In particular, the \ac{FWHM} can be used to ensure that the pulses are overlapped i.e. minimising the \ac{FWHM} in the histogram of detection events means that the pulses will be maximally overlapped.

Average photon number is harder to stabilise but is also the least susceptible to drifts. Having fibres glues onto chips and by using a stable current source to power the laser, it is unlikely that photon number will need often retuning.

\subsection{Wavelength Division Multiplexing}

As mentioned previously, there is no need to filter the pulses to see interference. This is important as it allows the transmitters to be easily wavelength tuned making it compatible with \ac{wdm} and possible classical-quantum multiplexing. An interesting demonstration of this would be to multiplex the quantum signals with classical data to verify that quantum interference can still be seen. This could be an important consideration for future networks.

\subsection{DFB Laser}

The delay caused by the laser relaxation after phase randomisation could be reduced by using a \ac{dfb} laser. \ac{DBR} lasers will take time to relax after gain switching as the cavity will support many modes until a single mode becomes dominant. This behaviour is shown in figure \ref{fig:gain_switch} where the laser oscillates before becoming more stable. 

%=========================================================